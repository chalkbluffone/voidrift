# Voidrift Project Scan Report

## REFACTORING OPPORTUNITIES

| #   | Location                                                    | Issue                                                                                                                                                                                                                                                |
| --- | ----------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 20  | radiant_arc.gd (836 lines) + snarky_comeback.gd (681 lines) | **500+ lines of duplicated code** — mesh generation, hitbox creation, particle setup, debug drawing. Should share a base class.                                                                                                                      |
| 21  | 8 spawner files                                             | **"Find nearest enemy" loop copy-pasted** across all spawners. Should be a shared utility function.                                                                                                                                                  |
| 24  | pause_menu.gd + options_menu.gd                             | **Duplicated options handlers** — identical `_on_master_volume_changed`, `_on_sfx_volume_changed`, etc. in both files. Extract a shared options controller.                                                                                          |
| 25  | settings_manager.gd                                         | `set_sfx_volume()` and `set_music_volume()` are nearly identical — extract `_set_bus_volume()`. Also `apply_all_settings()` duplicates setter logic.                                                                                                 |
| 26  | progression_manager.gd                                      | `add_credits()` and `add_stardust()` follow identical patterns. Extract shared helper.                                                                                                                                                               |
| 28  | upgrade_service.gd                                          | `generate_level_up_options()` is 115 lines. Decompose into `_build_module_candidates()`, `_build_weapon_candidates()`, `_select_from_candidates()`.                                                                                                  |
| 29  | 5 effect files                                              | `nikolas_coil.gd` (831), `nope_bubble.gd` (699), `radiant_arc.gd` (836), `snarky_comeback.gd` (681), `space_napalm.gd` (799) — all 700-836 lines. Particle/visual setup is 300-500 lines of procedural config that could use shared builder helpers. |

## UNUSED CODE

| #   | Location                                                   | Item                                                                                                                                                                                                                                                                                                 |
| --- | ---------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 30  | globals/data_loader.gd                                     | **11 getter functions never called**: `get_all_weapons()`, `get_all_ships()`, `get_all_captains()`, `get_all_items()`, `get_all_enemies()`, `get_weapon_ids()`, `get_all_weapon_upgrades()`, `get_weapon_upgrade_ids()`, `get_unlocked_weapons()`, `get_unlocked_ships()`, `get_unlocked_captains()` |
| 31  | globals/persistence_manager.gd                             | **8 methods never called**: `discover_synergy()`, `is_synergy_discovered()`, `get_total_runs()`, `increment_total_runs()`, `get_total_wins()`, `increment_total_wins()`, `get_high_score()`, `update_high_score()`, `update_best_time()`, `get_best_time()`, `add_time_played()`                     |
| 32  | globals/game_manager.gd                                    | **Deprecated compatibility facade** — entire file is a forwarding layer but still actively consumed. Constants `MAX_WEAPON_SLOTS`, `MAX_MODULE_SLOTS`, `XP_BASE`, `XP_GROWTH` duplicate `ProgressionManager`. `GameState` enum duplicates `RunManager`.                                              |
| 33  | globals/file_logger.gd                                     | `MAX_LOG_SIZE` constant, `log_custom()`, `get_log_path()` — never used                                                                                                                                                                                                                               |
| 34  | scripts/core/stats_component.gd                            | `roll_evasion()`, `print_stats()`, `set_base_stat()` — never called                                                                                                                                                                                                                                  |
| 36  | scripts/ui/level_up.gd                                     | Constants `COLOR_WEAPON`, `COLOR_UPGRADE`, `COLOR_BUTTON_HOVER` — never referenced                                                                                                                                                                                                                   |
| 37  | scripts/player/ship.gd                                     | `_on_hp_changed()` — connected to signal but body is just `pass`                                                                                                                                                                                                                                     |
| 38  | scripts/pickups/base_pickup.gd                             | `_check_fixed_radius_attraction()` — never called                                                                                                                                                                                                                                                    |
| 39  | effects/personal_space_violator/personal_space_violator.gd | `GameManager` `@onready` declared but never used; `_parse_color()` never called                                                                                                                                                                                                                      |
| 40  | effects/radiant_arc/radiant_arc.gd                         | `_generate_hitbox_polygon()` and `_aim_direction` — never used                                                                                                                                                                                                                                       |
| 41  | effects/beam_base/ + effects/projectile_base/              | **Entire stub directories** — both effect and spawner immediately `queue_free()` / return `null`. Dead placeholder code.                                                                                                                                                                             |

## STYLE VIOLATIONS (Systemic)

| Issue                             | Scope                                                                                                                                                   |
| --------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`:=` inferred typing**          | ~60+ occurrences across all globals, scripts, and effects. Project rules require explicit `: Type =`.                                                   |
| **Untyped `var`**                 | ~15+ occurrences. `var player =`, `var bus_idx =`, `var data =`, etc.                                                                                   |
| **Untyped `Array` returns**       | 11+ functions return `Array` instead of `Array[Dictionary]` or `Array[String]`                                                                          |
| **`"""` Python-style docstrings** | ~15+ occurrences across globals and effects. GDScript uses `##` for doc comments. Triple-quoted strings are discarded string literals, not actual docs. |
| **JSON values not cast**          | `ion_wake.gd` and `radiant_arc.gd` `load_from_data()` don't cast JSON values with `float()`/`int()`. Other effects do this correctly.                   |

## DOCUMENTATION INACCURACIES (copilot-instructions.md)

| #   | Section                 | Issue                                                                                                                                                                                                                                                                                                                                                                   |
| --- | ----------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 42  | Game Overview           | Says **"Godot 4.5"** — actual is **4.6**                                                                                                                                                                                                                                                                                                                                |
| 43  | Autoloads table         | Lists only 3 autoloads — **7 are missing** (GameConfig, PersistenceManager, RunManager, ProgressionManager, UpgradeService, FileLogger, SettingsManager)                                                                                                                                                                                                                |
| 44  | Scene Structure         | Lists `scenes/gameplay/obstacles/minable_asteroid.tscn` — **doesn't exist**. Missing `scenes/gameplay/projectile.tscn`, `scenes/ui/options_menu.tscn`, entire `scenes/pickups/` directory                                                                                                                                                                               |
| 45  | Script Structure        | **9 phantom files** listed that don't exist (`damage_system.gd`, `ship_controller.gd`, `phase_shift.gd`, `wave_spawner.gd`, `weapon_manager.gd`, `obstacle_manager.gd`, `xp_system.gd`, `minable_asteroid.gd`, `scripts/systems/run_manager.gd`). **4 directories missing** from docs (`scripts/combat/`, `scripts/core/abilities/`, `scripts/pickups/`, `scripts/ui/`) |
| 46  | Node Hierarchies        | Ship CollisionShape radius documented as 15, actual is **24.08**. PickupRange radius documented as 80, actual is **40**. BaseEnemy mask documented as 1, actual is **5**. BaseEnemy missing `HitboxArea` child node from docs                                                                                                                                           |
| 47  | Signal Flow             | Omits ProgressionManager/UpgradeService/RunManager delegation chain                                                                                                                                                                                                                                                                                                     |
| 48  | Implementation Priority | **13 of 25 items are completed** but all still marked `[ ]` unchecked                                                                                                                                                                                                                                                                                                   |
| 49  | Development Progress    | Missing 17 weapon effects, ship+captain system, weapon test lab, options menu, ability system from completed features. Last updated date is "January 24, 2026" — **3+ weeks stale**                                                                                                                                                                                     |
| 50  | Collision Masks table   | BaseEnemy mask documented as 1, actual is 5 (Player + Projectiles)                                                                                                                                                                                                                                                                                                      |
